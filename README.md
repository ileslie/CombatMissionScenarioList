# CombatMissionScenarioList

Scripts, XSLT, XML extra data and other resources to update the [combat mission scenario listing web site.](https://www.combatmission.lesliesoftware.com/index.html)

## Other tools required

For these scripts to work you need to have the following other programs installed.

* ___ScAn_CaDe___ The tool used to extract images and contained scenarios from scenarios, maps and campaigns.

  To use this you need to have a Java VM installed (see below).
   
* ___Image Magik___ The tool used to convert .BMP files into .jpg or .png files. Also used to create the custom images for theBlitz web site scenario pages.
* ___Saxton___
* ___Java VM___

## Cleaning up Generated Files

### cleanonelist.cmd

Removes the folders and .xml files generated by ScAn_CaDe. This will remove all .bmp, extracted campaign scenarios and the *_Listing.xml files.

```
cleanonelist gamename
Deletes the generated sub folders under gamename\Scenarios, gamename\Campaigns, gamename\Maps, gamename\QBMaps and the campaign, scenario, map and qbmap lists
```
The parameter ```gamename``` can be on of the folders corresponding to the game (e.g. "ColdWar", "BattelForNormandy" etc.).


### cleanalllists.cmd

Calls ```cleanonlist``` for each game directory. After this command all content generated by ScAn_CaDe will have been removed.

### cleanonehtml.cmd

Removes the html files generated by the XSLT transform (using Saxton) for the specified game.

```
cleanonehtml gamename
Deletes the generated html files for gamename
```

### cleanallhtml.cmd

Calls ```cleanonehtml``` for each game directgory. After this all html generated by the XSLT (Saxton) will be removed.

## Processing New Scenarios, Maps and Campaigns

### ParseShortCutLinks.jar

```
Parses the short cut files in a given directory creating an xml file containing file names and ulrs.
java ParseShortCutLinks [-f] -dir=<inputdir> -xmlout=<filename>

  -f            Force the overwrite of an existing output file without prompting.
  -url          Scan the input directory for .url files. One or more of -url, -btt and -cam must be specified
  -btt          Scan the input directory for .btt files. One or more of -url, -btt and -cam must be specified
  -cam          Scan the input directory for .cam files. One or more of -url, -btt and -cam must be specified
  -dir          Scan the directory of files with no extension and parse them to create the xml file.
    inputdir    The directory containing the short cut files to process.
  -xmlout       Save the xml file containing the list of file names and urls.
    filename    The file name fo the output xml file.
```

### createnewextrainfofile.cmd

Look at a list of .btt or .cam files in the named game folders and create a new ```Extra_Info.xml`` file but named ```Extra_Info_New.xml``. If you copy new .btt or .cam files along with their url short cuts into the official direcotry structure this can allow you to get xml entries for those new files. It is much better th call ```ParseShortcutLinks.jar``` directy in your download staging area. See 

```
createnewextrainfofile gamename
Run ParseShortCutLinks to update the Extra_Info.xml files under scenario, campaign, map and qbmap list for gamename.

This creates a Extra_Info_New.xml file for scenaro and campaign files for gamename. This allows you to manually  
edit the Extra_Info.xml and Extra_Info_New.xml file to merge any new scenario or campaign files added to the 
directory.
```


find_missing_scenarios.xsl

ftpall.cmd
ftpone.cmd
ftptoplevel.cmd

generateallhtml.cmd
generateonehtml.cmd

packageformapdataentry.cmd
scenario_campaign_listing.xsl

updateall.cmd
updatealllists.cmd
updatealllocally.cmd
updateonefully.cmd
updateonelist.cmd
updateonelocally.cmd

ParseShortCutLinks.jar
UpdateScenarioInfoURLs.jar
campaignscenarioextrainfogeneration.cmd

